{% extends 'FOSUserBundle::layout.html.twig' %}
{% block title %}
    <title>Konstruye.pe | {{ producto.nombre }}</title>
{% endblock title %}
{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/jquery.rateyo.min.css') }}">
    <link rel="stylesheet" href="{{ asset('css/masterslider.css') }}">
{% endblock %}

{% block fos_user_content %}

    <div class="container product-detail-section">
        <div class="col-md-6">
            <div class="ms-showcase2-template ms-showcase2-vertical">
                <!-- masterslider -->
                <div class="master-slider ms-skin-default" id="masterslider">
                    <div class="ms-slide">
                        <img src="{{ asset('css/loading-2.gif') }}" data-src="http://placehold.it/450x450" alt="lorem ipsum dolor sit"/>
                        <img class="ms-thumb" src="http://placehold.it/100x100" alt="thumb" />
                    </div>
                    <div class="ms-slide">
                        <img src="{{ asset('css/loading-2.gif') }}" data-src="http://placehold.it/450x450" alt="lorem ipsum dolor sit"/>
                        <img class="ms-thumb" src="http://placehold.it/100x100" alt="thumb" />
                    </div>
                    <div class="ms-slide">
                        <img src="{{ asset('css/loading-2.gif') }}" data-src="http://placehold.it/450x450" alt="lorem ipsum dolor sit"/>
                        <img class="ms-thumb" src="http://placehold.it/100x100" alt="thumb" />
                    </div>
                    <div class="ms-slide">
                        <img src="{{ asset('css/loading-2.gif') }}" data-src="http://placehold.it/450x450" alt="lorem ipsum dolor sit"/>
                        <img class="ms-thumb" src="http://placehold.it/100x100" alt="thumb" />
                    </div>
                    <div class="ms-slide">
                        <img src="{{ asset('css/loading-2.gif') }}" data-src="http://placehold.it/450x450" alt="lorem ipsum dolor sit"/>
                        <img class="ms-thumb" src="http://placehold.it/100x100" alt="thumb" />
                    </div>
                    <div class="ms-slide">
                        <img src="{{ asset('css/loading-2.gif') }}" data-src="http://placehold.it/450x450" alt="lorem ipsum dolor sit"/>
                        <img class="ms-thumb" src="http://placehold.it/100x100" alt="thumb" />
                    </div>
                    <div class="ms-slide">
                        <img src="{{ asset('css/loading-2.gif') }}" data-src="http://placehold.it/450x450" alt="lorem ipsum dolor sit"/>
                        <img class="ms-thumb" src="http://placehold.it/100x100" alt="thumb" />
                    </div>


                </div>
                <!-- end of masterslider -->
            </div>


        </div>

        <div class="col-md-6" style="padding: 20px">


            <h1>{{ producto.nombre }}</h1>
            <div id="rateYo" data-rating="{{ moy }}" style="margin: 5px 0; padding-left:0 "></div>
            <a href="{{ path('show_negocio',
            {"slug_seccion":"proveedores","slug_negocio":producto.negocio.slug}) }}"><h2>{{ producto.negocio.nombre }}</h2></a>
            <p>{{ producto.description }}</p>

        </div>
    </div>

    <div class="container">

        {% for type, messages in app.session.flashbag.all() %}
            {% for message in messages %}
                <div id="sucess" data-sucess="{{ message }}"></div>
            {% endfor %}
        {% endfor %}

        <div class="col-md-8 col-md-offset-2 star-form">
            {% if form is defined %}
                {{ form_start(form,{attr: {novalidate: 'novalidate'}}) }}
                <div class="rating-container">
                    <div style="margin: 10px auto " id="rateYo2"></div>
                    <div class="counter"></div>
                </div>
                {% if form.vars.errors|length>0 %}
                    <div class="alert alert-danger" role="alert">
                        <div> <i class="fa fa-exclamation-circle" aria-hidden="true"></i>{{ form_errors(form) }}</div>
                    </div>
                {% endif %}

                <div class="form-group">
                    {{ form_label(form.titulo,'Título') }}
                    {% if form.titulo.vars.errors|length>0 %}
                        <div class="alert alert-danger" role="alert">
                            <div> <i class="fa fa-exclamation-circle" aria-hidden="true"></i>{{ form_errors(form.titulo) }}</div>
                        </div>
                    {% endif %}

                    {{ form_widget(form.titulo,{ 'attr': {'class': 'form-control','placeholder':'¡Excelente!'}}) }}
                </div>
                <div class="form-group">
                    {{ form_label(form.comentario,'Comentario') }}
                    {% if form.comentario.vars.errors|length>0 %}
                        <div class="alert alert-danger" role="alert">
                            <div> <i class="fa fa-exclamation-circle" aria-hidden="true"></i>{{ form_errors(form.comentario) }}</div>
                        </div>
                    {% endif %}

                    {{ form_widget(form.comentario,{ 'attr': {'class': 'form-control','placeholder':'Tu comentario'}}) }}
                </div>

                <div class="form-group">
                    {{ form_widget(form.submit,{ 'attr': {'class': 'btn btn-konstruye'},'label': 'Enviar'}) }}
                </div>


                {{ form_end(form) }}
            {% endif %}
        </div>
    </div>


    <div class="container product-section" style="margin-top: 30px; text-align: center" >
        <h4>También te puede interesar</h4>
        <div class="row">
            <div class="col-md-3 producto-box">
                <img src="http://placehold.it/200x200" alt="">
                <a href=""><h1>Marmol 5x5</h1></a>
                <a href=""><h2>Trebol Celima</h2></a>
                <p>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star-o" aria-hidden="true"></i>
                </p>
            </div>
            <div class="col-md-3 producto-box">
                <img src="http://placehold.it/200x200" alt="">
                <a href=""><h1>Marmol 5x5</h1></a>
                <a href=""><h2>Trebol Celima</h2></a>
                <p>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star-o" aria-hidden="true"></i>
                </p>
            </div>
            <div class="col-md-3 producto-box">
                <img src="http://placehold.it/200x200" alt="">
                <a href=""><h1>Marmol 5x5</h1></a>
                <a href=""><h2>Trebol Celima</h2></a>
                <p>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star-o" aria-hidden="true"></i>
                </p>
            </div>
            <div class="col-md-3 producto-box">
                <img src="http://placehold.it/200x200" alt="">
                <a href=""><h1>Marmol 5x5</h1></a>
                <a href=""><h2>Trebol Celima</h2></a>
                <p>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star" aria-hidden="true"></i>
                    <i class="fa fa-star-o" aria-hidden="true"></i>
                </p>
            </div>
        </div>
    </div>

    <div class="container comments_details">
        <div class="col-md-6 col-md-offset-3 ">
            <h1>Comentarios ({{ comentarios|length }})</h1>
            {% for c in comentarios %}
                <div class="media comment">
                    <div class="media-left">
                        <img class="img-circle" alt="user icon" src="http://placehold.it/100x100x?text=Foto+Perfil">
                    </div>
                    <div class="media-body">
                        <h3>{{ c.titulo }}</h3>
                        <div class="rateYo_comments" style="padding-left: 0" data-rating="{{ c.nota }}"></div><span>{{ c.user.nombres }} </span>

                        <p>
                            {{ c.comentario }}
                        </p>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>



{% endblock fos_user_content %}


{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/jquery.rateyo.min.js') }}"></script>
    <script src="{{ asset('js/masterslider.min.js') }}" type="text/javascript"></script>
    <script type="text/javascript">


        var errormsn = $("#sucess").attr("data-sucess");

        if(errormsn!=undefined)
            noty({
                text: errormsn,
                animation: {
                    open: 'animated bounceInLeft', // Animate.css class names
                    close: 'animated bounceOutRight', // Animate.css class names
                    easing: 'swing', // easing
                    speed: 800 // opening & closing animation speed
                },
                'layout':'bottomCenter',
                type: 'success',
                timeout:3000
            });



        var color="#30BDEF";
        var test = $("#rateYo").attr("data-rating");

        $("#rateYo").rateYo({
            rating: test,
            ratedFill: color,
            starWidth: "25px",
            normalFill: "#A0A0A0",
            readOnly: true
        });


        var recuperar = $("#comentario_producto_nota").attr("value");

        $("#rateYo2").rateYo({
                    rating: recuperar,
                    ratedFill: "#0097C9",
                    normalFill: "#A0A0A0",
                    starWidth: "60px",
                    onChange: function (rating, rateYoInstance) {
                        $(this).next().text(rating);
                    }

                })
                .on("rateyo.set", function (e, data) {
                    $("#comentario_producto_nota").val(data.rating);
                    $("#rateYo2").rateYo("option", "readOnly", true);
                    $("#rateYo2").rateYo("option", "ratedFill", "#30BDEF");
                });


        $("#rateYo2").mouseleave(function(){
            $("#rateYo2").rateYo("option", "readOnly", false);
        });
        $("#rateYo2").mouseenter(function(){
            $("#rateYo2").rateYo("option", "ratedFill", color);
        });

        $( ".rateYo_comments" ).each(function( index ) {
            $(this).rateYo({
                rating: $(this).attr("data-rating"),
                starWidth: "20px",
                readOnly: true,
                ratedFill: color,
                normalFill: "#A0A0A0"
            });
        });
        var slider = new MasterSlider();

        slider.control('arrows');
        slider.control('scrollbar' , {dir:'h'});
        slider.control('thumblist' , {autohide:false, dir:'v', arrows:true, align:'left', width:100, height:100, margin:5, space:5, hideUnder:300});

        slider.setup('masterslider' , {
            width:450,
            height:450,
            grabCursor:false,
            space:5
        });



    </script>

{% endblock javascripts %}